<div class="order-detail-container">
  <div class="header">
    <button class="btn-back" (click)="goBack()">‚Üê Back</button>
    <h1>Order Details</h1>
  </div>

  <div class="content" *ngIf="!loading && order; else loadingTemplate">
    <!-- Order Summary Card -->
    <div class="order-summary">
      <h2>Order #{{ order.id }}</h2>
      <div class="summary-grid">
        <div class="summary-item">
          <span class="label">Order Date:</span>
          <span class="value">{{ order.orderTime | date:'medium' }}</span>
        </div>
        <div class="summary-item">
          <span class="label">Status:</span>
          <span class="status-badge" [class]="'status-' + order.status?.toLowerCase()">
            {{ order.status }}
          </span>
        </div>
        <div class="summary-item">
          <span class="label">Total Amount:</span>
          <span class="value total">${{ order.total?.toFixed(2) }}</span>
        </div>
        <div class="summary-item" *ngIf="order.shippingAddress">
          <span class="label">Shipping Address:</span>
          <span class="value">{{ order.shippingAddress }}</span>
        </div>
      </div>

      <div class="actions" *ngIf="order.status === 'PROCESSING'">
        <button class="btn-cancel" (click)="cancelOrder()">Cancel Order</button>
      </div>
      <div class="actions" *ngIf="isAdmin && order.status === 'PROCESSING'">
        <button class="btn-complete" (click)="completeOrder()">Complete Order</button>
      </div>
    </div>

    <!-- Order Items -->
    <div class="order-items">
      <h2>Order Items</h2>
      <div class="items-list">
        <div class="item-card" *ngFor="let item of order.items">
          <div class="item-info">
            <h3>{{ item.productName }}</h3>
            <div class="item-details">
              <span class="quantity">Quantity: {{ item.quantity }}</span>
              <span class="price">Unit Price: ${{ (item.retailPriceAtOrder)?.toFixed(2) }}</span>
              <span class="subtotal">Subtotal: ${{ ((item.retailPriceAtOrder ?? 0) * (item.quantity ?? 0)).toFixed(2) }}</span>
            </div>
          </div>
        </div>
        <div *ngIf="!order.items || order.items.length === 0" class="no-items">
          No items in this order
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #loadingTemplate>
  <div class="loading">Loading order details...</div>
</ng-template>
