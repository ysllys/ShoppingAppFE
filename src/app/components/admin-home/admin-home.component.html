<div class="admin-home-container">
  <div class="header">
    <h1>Admin Dashboard</h1>
    <button class="btn-primary" (click)="navigateToProductManagement()">
      Manage Products
    </button>
  </div>

  <!-- Statistics Cards -->
  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-icon">üì¶</div>
      <div class="stat-info">
        <h3>Total Orders</h3>
        <p class="stat-value">{{ orders.length }}</p>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">‚úÖ</div>
      <div class="stat-info">
        <h3>Total Sold Items</h3>
        <p class="stat-value">{{ totalSoldItems }}</p>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">‚≠ê</div>
      <div class="stat-info">
        <h3>Popular Products</h3>
        <p class="stat-value">{{ popularProducts.length }}</p>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">üí∞</div>
      <div class="stat-info">
        <h3>Top Profit Products</h3>
        <p class="stat-value">{{ profitableProducts.length }}</p>
      </div>
    </div>
  </div>

  <!-- Orders Management -->
  <div class="section">
    <h2>Orders Management</h2>
    <div class="table-container" *ngIf="!loading; else loadingTemplate">
      <table class="data-table">
        <thead>
          <tr>
            <th>Order ID</th>
            <th>Customer</th>
            <th>Date</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let order of orders">
            <td>#{{ order.id }}</td>
            <td>{{ order.placedByUsername || order.userId }}</td>
            <td>{{ order.orderTime | date:'short' }}</td>
            <td>
              <span class="status-badge" [class]="'status-' + order.status?.toLowerCase()">
                {{ order.status }}
              </span>
            </td>
            <td>
              <div class="action-buttons">
                <button class="btn-action btn-view" (click)="viewOrder(order.id)">View</button>
                <button class="btn-action btn-complete"
                        (click)="completeOrder(order.id)"
                        *ngIf="order.status === 'PROCESSING'"
                        [disabled]="order.status === 'COMPLETED' || order.status === 'CANCELLED'">
                  Complete
                </button>
                <button class="btn-action btn-cancel"
                        (click)="cancelOrder(order.id)"
                        *ngIf="order.status === 'PROCESSING'"
                        [disabled]="order.status === 'COMPLETED' || order.status === 'CANCELLED'">
                  Cancel
                </button>
              </div>
            </td>
          </tr>
          <tr *ngIf="orders.length === 0">
            <td colspan="6" class="no-data">No orders found</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Product Analytics -->
  <div class="analytics-section">
    <!-- Most Profitable Products -->
    <div class="analytics-card">
      <h2>Most Profitable Products</h2>
      <div class="product-list">
        <div class="product-item" *ngFor="let product of profitableProducts">
          <img [src]="product.imageUrl || 'assets/placeholder.jpg'" [alt]="product.name">
          <div class="product-info">
            <h4>{{ product.product.name }}</h4>
            <p class="price">${{ product.retailPrice?.toFixed(2) }}</p>
            <p class="profit" *ngIf="product.totalProfit">Profit: ${{ product.totalProfit?.toFixed(2) }}</p>
          </div>
        </div>
        <div *ngIf="profitableProducts.length === 0" class="no-data">No data available</div>
      </div>
    </div>

    <!-- Most Popular Products -->
    <div class="analytics-card">
      <h2>Most Popular Products</h2>
      <div class="product-list">
        <div class="product-item" *ngFor="let product of popularProducts">
          <img [src]="product.imageUrl || 'assets/placeholder.jpg'" [alt]="product.name">
          <div class="product-info">
            <h4>{{ product.product.name }}</h4>
            <p class="price">${{ product.retailPrice?.toFixed(2) }}</p>
            <p class="sales" *ngIf="product.totalSold">Sold: {{ product.totalSold }} units</p>
          </div>
        </div>
        <div *ngIf="popularProducts.length === 0" class="no-data">No data available</div>
      </div>
    </div>
  </div>
</div>

<ng-template #loadingTemplate>
  <div class="loading">Loading...</div>
</ng-template>
